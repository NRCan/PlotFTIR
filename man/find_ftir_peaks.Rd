% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/peak-fit.R
\name{find_ftir_peaks}
\alias{find_ftir_peaks}
\title{Find FTIR Peaks}
\usage{
find_ftir_peaks(ftir, ...)
}
\arguments{
\item{ftir}{A data.frame in long format with a single FTIR spectra in columns
\code{sample_id}, \code{wavenumber}, and \code{absorbance}. The \code{absorbance} column may be
replaced by a \code{transmittance} column for transmittance plots.

Un data.frame au format long avec un seul spectre IRTF dans les colonnes
\code{sample_id}, \code{wavenumber}, et \code{absorbance}. La colonne \code{absorbance} peut
être remplacée par une colonne \code{transmittance} pour les tracés de
transmittance.}

\item{...}{Additional optional parameters to pass to peak finding algorithm.
\itemize{
\item \code{sg_p_norm} The polynomial degree used in smoothing the spectra for finding peaks by signal maxima. Default \code{3}.
\item \code{sg_p_deriv} The polynomial degree used in smoothing the derivative for finding peaks by minima. Default \code{3}.
\item \code{sg_n_norm} The number of points used in smoothing the spectra for finding peaks by signal maxima. Default \code{13}.
\item \code{sg_n_deriv} The number of points used in smoothing the derivative for finding peaks by minima. Default \code{13}.
\item \code{window_norm} The width of the window (in wavenumbers) to ensure that a peak is a true maxima and not just noise. Default \code{10}. Works best on data with consistent resolution, and will round up to the next data point.
\item \code{window_deriv} The width of the window (in wavenumbers) to ensure that a derivative minima is a true minima and not just noise. Default \code{5}. Works best on data with consistent resolution, and will round up to the next data point.
\item \code{window_align} The width of the window (in wavenumbers) whereby derivative and normal peaks are compared. Normal peaks are added to the derivative peak list if they are outside of the window distance of any other peak
\item \code{zero_norm} Spectra have baseline noise removed before searching for peaks by setting signal value below the zero threshold to 0. Default \code{1e-2}.
\item \code{zero_deriv}Derivative have baseline noise removed before searching for peaks by setting values below the zero threshold to 0. Default \code{1e-4}.

Paramètres optionnels supplémentaires à transmettre à l'algorithme de
recherche de pics. #' * \code{sg_p_norm} Le degré polynomial utilisé pour lisser
les spectres afin de trouver les pics par les maxima du signal. Valeur par
défaut \code{3}.
\item \code{sg_p_deriv} Le degré polynomial utilisé dans le lissage de la dérivée pour trouver les pics par les minima. Par défaut \code{3}.
\item \code{sg_n_norm} Le nombre de points utilisés pour lisser les spectres afin de trouver les pics par maxima du signal. Valeur par défaut \code{13}.
\item \code{sg_n_deriv} Le nombre de points utilisés dans le lissage de la dérivée pour trouver les pics par minima. Par défaut \code{13}.
\item \code{window_norm} La largeur de la fenêtre (en wavenumbers) pour s'assurer qu'un pic est un vrai maxima et pas seulement du bruit. Valeur par défaut \code{10}. Fonctionne mieux sur des données avec une résolution cohérente, et arrondit au point de données suivant.
\item \code{window_deriv} La largeur de la fenêtre (en wavenumbers) pour s'assurer qu'un minima de dérivée est un vrai minima et pas seulement du bruit. Valeur par défaut \code{5}. Fonctionne mieux sur des données avec une résolution cohérente, et arrondira au point de données suivant.
\item \code{window_align} La largeur de la fenêtre (en wavenumbers) par laquelle les pics dérivés et normaux sont comparés. Les pics normaux sont ajoutés à la liste des pics dérivés s'ils se trouvent à l'extérieur de la distance de la fenêtre de tout autre pic.
\item \code{zero_norm} Les spectres sont débarrassés du bruit de base avant de rechercher les pics en fixant à 0 la valeur du signal en dessous du seuil zéro. Valeur par défaut \code{1e-2}.
\item \code{zero_deriv}La dérivée est débarrassée du bruit de base avant la recherche des pics en fixant à 0 les valeurs inférieures au seuil zéro. Valeur par défaut \code{1e-4}.
}}
}
\value{
A vector of wavenumbers corresponding to peaks found in the provided
FTIR spectra.

Un vecteur de nombres d'ondes correspondant aux pics trouvés dans les
spectres IRTF fournis.
}
\description{
This function finds peaks in FTIR spectra by identifying minima
of the double derivative, then re-scanning for maxima of peaks missed by
the derivative method. This double-check ensures that both sharp peaks
(like C-H stretch) and wide gentle peaks (like O-H stretch) are found. The
spectra is smoothed by a Savitzky-Golay filter prior to analysis and as
such there are a number of optional tuning parameters that can be provided
(the defaults work well for typical spectra).

Cette fonction permet de trouver des pics dans les spectres IRTF en
identifiant les minima de la double dérivée, puis en recherchant à nouveau
les maxima des pics manqués par la méthode de la dérivée. Cette double
vérification permet de s'assurer que les pics aigus (comme l'étirement C-H)
et les pics larges et doux (comme l'étirement O-H) sont trouvés. Le spectre
est lissé par un filtre de Savitzky-Golay avant l'analyse et, à ce titre,
un certain nombre de paramètres de réglage facultatifs peuvent être fournis
(les valeurs par défaut fonctionnent bien pour les spectres typiques).
}
\examples{
# Load the isopropanol sample spectrum from the PlotFTIR package
ftir_data <- PlotFTIR::sample_spectra[
  PlotFTIR::sample_spectra$sample_id == "isopropanol",
]

# Find peaks using default settings
peaks_default <- find_ftir_peaks(ftir_data)
print("Peaks found with default settings:")
print(peaks_default)

# Find peaks with adjusted smoothing and window parameters
# Example: Less smoothing on derivative, wider window for normal peaks
peaks_adjusted <- find_ftir_peaks(
  ftir_data,
  sg_n_deriv = 11, # Fewer points for derivative smoothing
  window_norm = 15 # Wider window (wavenumbers) for normal peak check
)
print("Peaks found with adjusted settings:")
print(peaks_adjusted)
}
\references{
Savitzky, A.; Golay, M.J.E. (1964). "Smoothing and
Differentiation of Data by Simplified Least Squares Procedures". Analytical
Chemistry 36. pp. 1627–1639. doi:10.1021/ac60214a047
}
\seealso{
\code{\link[signal:sgolayfilt]{signal::sgolayfilt()}}, \code{\link[=smooth_ftir]{smooth_ftir()}}, \code{\link[=shift_baseline]{shift_baseline()}}
}
